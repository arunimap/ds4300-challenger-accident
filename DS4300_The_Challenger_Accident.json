{"paragraphs":[{"text":"// Read temperature data for 1986 and station data\nval temps_1986 = spark.read.csv(\"/Users/arunima/Desktop/ArunimaMAC/Education/Northeastern/Year_3/ds4300/HW/ds4300-challenger-accident/temperatures/1986.csv\").toDF(\"STATION\", \"WBAN\", \"MONTH\", \"DAY\", \"TEMP\")\nval stations = spark.read.csv(\"/Users/arunima/Desktop/ArunimaMAC/Education/Northeastern/Year_3/ds4300/HW/ds4300-challenger-accident/temperatures/stations.csv\").toDF(\"STATION\", \"WBAN\", \"LAT\", \"LON\")","user":"anonymous","dateUpdated":"2020-04-10T10:39:09-0400","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"temps_1986: org.apache.spark.sql.DataFrame = [STATION: string, WBAN: string ... 3 more fields]\nstations: org.apache.spark.sql.DataFrame = [STATION: string, WBAN: string ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1586524788789_-1469670575","id":"20180318-191454_284618957","dateCreated":"2020-04-10T09:19:48-0400","dateStarted":"2020-04-10T10:39:09-0400","dateFinished":"2020-04-10T10:39:10-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10208"},{"text":"// Filter bad Stations where the latitude or longitude is unavailable, convert temp, long, and lat to doubles\nval stations_clean = stations.filter(($\"LAT\".isNotNull) && ($\"LON\".isNotNull)).selectExpr(\"STATION\", \"WBAN\", \"cast(LAT as double) LAT\", \"cast(LON as double) LON\")\n\n// Filtered only to include temperature data for JANUARY 28th, 1986\nval temps_19860128 = temps_1986.filter(($\"MONTH\" === \"01\") && ($\"DAY\" === \"28\")).selectExpr(\"STATION\", \"WBAN\", \"MONTH\", \"DAY\", \"cast(TEMP as double)\")","user":"anonymous","dateUpdated":"2020-04-10T10:39:10-0400","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"stations_clean: org.apache.spark.sql.DataFrame = [STATION: string, WBAN: string ... 2 more fields]\ntemps_19860128: org.apache.spark.sql.DataFrame = [STATION: string, WBAN: string ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1586524788811_-1070842624","id":"20180318-191924_1310538952","dateCreated":"2020-04-10T09:19:48-0400","dateStarted":"2020-04-10T10:39:10-0400","dateFinished":"2020-04-10T10:39:11-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10209"},{"text":"// Define a function that compute the distance between two points on the Earth using the Haversine formula\n// https://www.movable-type.co.uk/scripts/latlong.html\n// Declare the function as a UDF (User-defined function) so that it can be applied\n\nval pi = 3.14159265\nval REarth = 6371.0 // kilometers\ndef toRadians(x: Double): Double = x * pi / 180.0\n\ndef haversine(lat1: Double, lon1: Double, lat2: Double, lon2: Double): Double = {\n    var φ1 = toRadians(lat1);\n    var φ2 = toRadians(lat2);\n    var Δφ = toRadians(lat2-lat1);\n    var Δλ = toRadians(lon2-lon1);\n\n    var a = Math.sin(Δφ/2) * Math.sin(Δφ/2) +\n            Math.cos(φ1) * Math.cos(φ2) *\n            Math.sin(Δλ/2) * Math.sin(Δλ/2);\n    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n\n    REarth * c;\n}\n\n\n// Now you can use \"haver\" as a function with Spark SQL \nimport org.apache.spark.sql.functions.udf\nval haver = udf(haversine _)","user":"anonymous","dateUpdated":"2020-04-10T10:39:11-0400","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"pi: Double = 3.14159265\nREarth: Double = 6371.0\ntoRadians: (x: Double)Double\nhaversine: (lat1: Double, lon1: Double, lat2: Double, lon2: Double)Double\nimport org.apache.spark.sql.functions.udf\nhaver: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function4>,DoubleType,Some(List(DoubleType, DoubleType, DoubleType, DoubleType)))\n"}]},"apps":[],"jobName":"paragraph_1586524788813_989235362","id":"20180318-195342_1996330025","dateCreated":"2020-04-10T09:19:48-0400","dateStarted":"2020-04-10T10:39:11-0400","dateFinished":"2020-04-10T10:39:12-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10210"},{"text":"// Find all stations within 100 km using your haversine function\n\nval capeCanaveralLatitude = 28.388382\nval capeCanaveralLongitude = -80.603498\n\nval stations_clean_near = stations_clean.withColumn(\"CapeCanaveralDist\", haver($\"LAT\", $\"LON\", lit(capeCanaveralLatitude), lit(capeCanaveralLongitude))).filter($\"CapeCanaveralDist\" < 100)","user":"anonymous","dateUpdated":"2020-04-10T10:39:12-0400","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"capeCanaveralLatitude: Double = 28.388382\ncapeCanaveralLongitude: Double = -80.603498\nstations_clean_near: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [STATION: string, WBAN: string ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1586524788814_-752283570","id":"20180318-191955_1910278437","dateCreated":"2020-04-10T09:19:48-0400","dateStarted":"2020-04-10T10:39:12-0400","dateFinished":"2020-04-10T10:39:13-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10211"},{"text":"// Use inverse distance weighting to estimate the temperature at Cape Canaveral on that day\n// inverse distance weighting: https://en.wikipedia.org/wiki/Inverse_distance_weighting (Use p=2 in the formula)\n\n// create inverse distance weight calculation function\ndef inv_dist_weight(dist: Double, p: Double): Double = {\n    1/(scala.math.pow(dist, p))\n}\nval weight = udf(inv_dist_weight _) // create udf\n\n// Calculate weights and apply to temp recordings with 100 miles on date of accident\nval stations_weight = stations_clean_near.withColumn(\"Weight\", weight($\"CapeCanaveralDist\", lit(2)))\nval near_temps = stations_weight.join(temps_19860128, Seq(\"STATION\", \"WBAN\")).withColumn(\"weighted_temp\", $\"TEMP\" * $\"Weight\")","user":"anonymous","dateUpdated":"2020-04-10T10:39:13-0400","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"inv_dist_weight: (dist: Double, p: Double)Double\nweight: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function2>,DoubleType,Some(List(DoubleType, DoubleType)))\nstations_weight: org.apache.spark.sql.DataFrame = [STATION: string, WBAN: string ... 4 more fields]\nnear_temps: org.apache.spark.sql.DataFrame = [STATION: string, WBAN: string ... 8 more fields]\n"}]},"apps":[],"jobName":"paragraph_1586524788815_158933089","id":"20180319-091159_1767904139","dateCreated":"2020-04-10T09:19:48-0400","dateStarted":"2020-04-10T10:39:13-0400","dateFinished":"2020-04-10T10:39:13-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10212"},{"text":"// Once you have the weighted sum of temperatures (numerator) and the sum of the weights (denominator) you can obtain your final result\nnear_temps.select(sum(\"weighted_temp\") / sum(\"Weight\")).show()","user":"anonymous","dateUpdated":"2020-04-10T10:39:13-0400","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------------------+\n|(sum(weighted_temp) / sum(Weight))|\n+----------------------------------+\n|                 36.98881742748224|\n+----------------------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1586524788816_1010259993","id":"20180318-194257_301533474","dateCreated":"2020-04-10T09:19:48-0400","dateStarted":"2020-04-10T10:39:13-0400","dateFinished":"2020-04-10T10:39:19-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10213"},{"text":"// Extra Credit: Find average temperature each day in 1986 to see how Jan 28th compares to days preceeding and following\n// (suggested by Professor Rachlin in lecture to see if moving the launch date by even a few days could changed the outcome)\nval full_1986 = stations_weight.join(temps_1986, Seq(\"STATION\", \"WBAN\")).withColumn(\"weighted_temp\", $\"TEMP\" * $\"Weight\")\nfull_1986.createOrReplaceTempView(\"full_1986\")","user":"anonymous","dateUpdated":"2020-04-10T10:39:19-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"full_1986: org.apache.spark.sql.DataFrame = [STATION: string, WBAN: string ... 8 more fields]\n"}]},"apps":[],"jobName":"paragraph_1586524875970_1431149558","id":"20200410-092115_1324131284","dateCreated":"2020-04-10T09:21:15-0400","dateStarted":"2020-04-10T10:39:19-0400","dateFinished":"2020-04-10T10:39:20-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10215"},{"text":"%sql\n-- Plot of full 1986 estimated temperatures\n-- Looking at the chart, it appears that the temperature the day of the Challenger Accident is lower than the days leading and following it. \nselect CAST(CONCAT('1986', '-' , MONTH, '-', DAY) AS DATE) AS dat, \n       SUM(weighted_temp)/SUM(Weight) AS estimated_temp\nfrom full_1986\nGROUP BY CONCAT('1986', '-' , MONTH, '-', DAY)\nORDER BY dat ASC","user":"anonymous","dateUpdated":"2020-04-10T10:39:20-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"stackedAreaChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"dat":"string","estimated_temp":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","style":"stack"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"dat","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"estimated_temp","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1586525137103_-1557874592","id":"20200410-092537_1669750775","dateCreated":"2020-04-10T09:25:37-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10216","dateFinished":"2020-04-10T10:39:26-0400","dateStarted":"2020-04-10T10:39:20-0400","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"dat\testimated_temp\n1986-01-01\t64.15183483059512\n1986-01-02\t66.23216544080049\n1986-01-03\t62.90336321304661\n1986-01-04\t66.20150508930124\n1986-01-05\t61.9508087965691\n1986-01-06\t54.04102660399478\n1986-01-07\t63.97174685328635\n1986-01-08\t62.91216978011024\n1986-01-09\t64.77690354861063\n1986-01-10\t68.06567723165129\n1986-01-11\t61.228902557925544\n1986-01-12\t57.6942628680815\n1986-01-13\t56.501973426174914\n1986-01-14\t52.28242690485097\n1986-01-15\t53.92602595287195\n1986-01-16\t58.68801105289906\n1986-01-17\t65.31942434700724\n1986-01-18\t64.21973528907402\n1986-01-19\t65.85475587959648\n1986-01-20\t59.70732029155526\n1986-01-21\t56.415272787508044\n1986-01-22\t60.728049243917766\n1986-01-23\t62.07046860569379\n1986-01-24\t60.915157821261424\n1986-01-25\t62.48639448763891\n1986-01-26\t60.98488621329543\n1986-01-27\t48.680360226799216\n1986-01-28\t36.98881742748224\n1986-01-29\t45.623596747500294\n1986-01-30\t54.91687137201036\n1986-01-31\t58.41421081773921\n1986-02-01\t64.32116672472769\n1986-02-02\t64.24824194044737\n1986-02-03\t64.26078574081104\n1986-02-04\t65.64168891092676\n1986-02-05\t68.6652810355581\n1986-02-06\t69.38064042502707\n1986-02-07\t66.92652150229645\n1986-02-08\t66.50973306732111\n1986-02-09\t63.52932698844704\n1986-02-10\t71.22821376787581\n1986-02-11\t69.4322585034991\n1986-02-12\t56.02046156573826\n1986-02-13\t48.44935651048872\n1986-02-14\t52.83283439832808\n1986-02-15\t62.86452136221481\n1986-02-16\t61.05380983821948\n1986-02-17\t66.3552112105887\n1986-02-18\t66.79813532286575\n1986-02-19\t68.20203017791137\n1986-02-20\t68.61271881078704\n1986-02-21\t66.7919612640956\n1986-02-22\t68.77514803682496\n1986-02-23\t66.23233789739052\n1986-02-24\t64.26603508606273\n1986-02-25\t57.73784081720869\n1986-02-26\t54.20224355609792\n1986-02-27\t63.44190546073061\n1986-02-28\t61.713124964326056\n1986-03-01\t51.116792600008104\n1986-03-02\t47.42811365020876\n1986-03-03\t55.19885719941303\n1986-03-04\t61.31671516136876\n1986-03-05\t56.44512448235286\n1986-03-06\t56.75797606202443\n1986-03-07\t59.201978053349656\n1986-03-08\t60.160168231866024\n1986-03-09\t67.31373852769329\n1986-03-10\t67.10350857972105\n1986-03-11\t70.14981164079238\n1986-03-12\t70.15407960125714\n1986-03-13\t71.38582203149372\n1986-03-14\t69.67251173097391\n1986-03-15\t68.62847075340318\n1986-03-16\t68.22952170005993\n1986-03-17\t68.60066742323271\n1986-03-18\t70.37589991779184\n1986-03-19\t72.78569599185322\n1986-03-20\t75.74734269990073\n1986-03-21\t58.64638452418997\n1986-03-22\t52.98853778762792\n1986-03-23\t53.4483223232167\n1986-03-24\t60.46416990843424\n1986-03-25\t66.49870244299511\n1986-03-26\t68.05516807587829\n1986-03-27\t66.7994275780314\n1986-03-28\t66.47004216026727\n1986-03-29\t66.46052155464268\n1986-03-30\t67.80822965613558\n1986-03-31\t67.06309073231553\n1986-04-01\t66.83866464179567\n1986-04-02\t67.02505514462379\n1986-04-03\t69.0278689110296\n1986-04-04\t71.8799547326569\n1986-04-05\t71.5944920390945\n1986-04-06\t71.58285411930284\n1986-04-07\t69.91654205059669\n1986-04-08\t72.66922651893614\n1986-04-09\t69.93506492683457\n1986-04-10\t63.81519916562679\n1986-04-11\t65.49091568052064\n1986-04-12\t66.41072658573205\n1986-04-13\t68.45290894595422\n1986-04-14\t68.30922217745366\n1986-04-15\t70.70105587328217\n1986-04-16\t71.89365975556531\n1986-04-17\t65.12450396440516\n1986-04-18\t64.36463220808277\n1986-04-19\t68.03492068711392\n1986-04-20\t69.70489947117457\n1986-04-21\t72.45906728081303\n1986-04-22\t69.64790103444666\n1986-04-23\t63.02531793604602\n1986-04-24\t65.53334329597511\n1986-04-25\t66.42113711492031\n1986-04-26\t69.43308394131266\n1986-04-27\t71.67793089196297\n1986-04-28\t72.98117890096188\n1986-04-29\t73.85145734897723\n1986-04-30\t72.68540197731133\n1986-05-01\t75.36982405851361\n1986-05-02\t78.42309737622948\n1986-05-03\t76.07946185288543\n1986-05-04\t76.79471071882672\n1986-05-05\t75.70754091020399\n1986-05-06\t77.4967725648501\n1986-05-07\t76.73965942634183\n1986-05-08\t75.81035894591848\n1986-05-09\t76.36121888061635\n1986-05-10\t75.1215602410306\n1986-05-11\t72.19075361051401\n1986-05-12\t71.97643520018285\n1986-05-13\t74.83463520403112\n1986-05-14\t76.472082417636\n1986-05-15\t77.14190111691038\n1986-05-16\t76.18443191367864\n1986-05-17\t75.95875809253224\n1986-05-18\t77.22175676285399\n1986-05-19\t77.69449986896177\n1986-05-20\t77.6416801647695\n1986-05-21\t75.61469580516012\n1986-05-22\t76.0851532357965\n1986-05-23\t78.03268003475542\n1986-05-24\t78.29833605962973\n1986-05-25\t77.61489886651368\n1986-05-26\t80.44697528715908\n1986-05-27\t80.66746938916877\n1986-05-28\t80.52026878378699\n1986-05-29\t78.83130783588662\n1986-05-30\t78.46931365616996\n1986-05-31\t79.85750472009582\n1986-06-01\t81.63226707842932\n1986-06-02\t81.50426538941261\n1986-06-03\t81.35967079389431\n1986-06-04\t82.05124796362288\n1986-06-05\t81.44806367810283\n1986-06-06\t80.68329179113618\n1986-06-07\t82.96212266091376\n1986-06-08\t82.35155631605826\n1986-06-09\t81.32315287664699\n1986-06-10\t82.17503367263883\n1986-06-11\t82.76113065761785\n1986-06-12\t79.67684268351614\n1986-06-13\t79.69084400824455\n1986-06-14\t79.50128148190375\n1986-06-15\t79.27585906937752\n1986-06-16\t78.97225123700451\n1986-06-17\t78.56829347116522\n1986-06-18\t77.4215009968445\n1986-06-19\t79.59315006233864\n1986-06-20\t76.39404642898079\n1986-06-21\t77.29701570419138\n1986-06-22\t81.45485373263563\n1986-06-23\t81.66387358633625\n1986-06-24\t81.36509187548205\n1986-06-25\t80.09844030724484\n1986-06-26\t80.38321541082405\n1986-06-27\t83.12316020260587\n1986-06-28\t83.02898622562455\n1986-06-29\t81.71096029843551\n1986-06-30\t81.18523396711467\n1986-07-01\t81.51492863199954\n1986-07-02\t81.7785734560699\n1986-07-03\t80.47112516211436\n1986-07-04\t77.71925376878163\n1986-07-05\t79.96580330172297\n1986-07-06\t79.67428013800583\n1986-07-07\t81.68658429687277\n1986-07-08\t83.08307733158655\n1986-07-09\t83.55584168833458\n1986-07-10\t84.11919320422655\n1986-07-11\t82.92088759095267\n1986-07-12\t80.98287217795209\n1986-07-13\t80.3184582989745\n1986-07-14\t82.78798394557475\n1986-07-15\t84.44609349286257\n1986-07-16\t84.36156591915726\n1986-07-17\t84.07038237336575\n1986-07-18\t83.38018671749714\n1986-07-19\t84.61055560328782\n1986-07-20\t87.18114476418846\n1986-07-21\t85.50965922969746\n1986-07-22\t80.35625694381731\n1986-07-23\t79.14162804926548\n1986-07-24\t80.33190113439714\n1986-07-25\t81.6436072448298\n1986-07-26\t81.31021461289168\n1986-07-27\t80.29397551856387\n1986-07-28\t80.31427616587646\n1986-07-29\t81.04423686081705\n1986-07-30\t82.90692631298589\n1986-07-31\t83.96368996322893\n1986-08-01\t82.47583357315273\n1986-08-02\t83.61102619288908\n1986-08-03\t82.69003180723466\n1986-08-04\t80.87858644485837\n1986-08-05\t80.08892684812851\n1986-08-06\t81.2477106698573\n1986-08-07\t83.07687179514978\n1986-08-08\t82.95349548990843\n1986-08-09\t84.2953486498596\n1986-08-10\t84.32362863602715\n1986-08-11\t79.80294960911237\n1986-08-12\t78.83528824719379\n1986-08-13\t79.07123162396704\n1986-08-14\t79.55283447348741\n1986-08-15\t80.54474335376972\n1986-08-16\t81.43432826816306\n1986-08-17\t82.13417402753657\n1986-08-18\t81.83991997385426\n1986-08-19\t80.26236688064988\n1986-08-20\t78.6174157932748\n1986-08-21\t79.3806426713178\n1986-08-22\t81.80441015853926\n1986-08-23\t82.6264990131691\n1986-08-24\t82.65926610870795\n1986-08-25\t84.06751757975995\n1986-08-26\t84.3078309192413\n1986-08-27\t83.4238883611676\n1986-08-28\t81.67595869122408\n1986-08-29\t81.03940121703478\n1986-08-30\t83.62113002428329\n1986-08-31\t83.82435329874394\n1986-09-01\t82.72833202339251\n1986-09-02\t82.49731261140342\n1986-09-03\t82.07991395526788\n1986-09-04\t83.15402406462933\n1986-09-05\t83.84283171587873\n1986-09-06\t80.57640224295089\n1986-09-07\t80.36418674680247\n1986-09-08\t80.28831896404662\n1986-09-09\t80.25001666389511\n1986-09-10\t80.5136771723486\n1986-09-11\t83.65006130867687\n1986-09-12\t82.61682983441621\n1986-09-13\t82.66844879677046\n1986-09-14\t82.78165549496761\n1986-09-15\t84.16183170463378\n1986-09-16\t83.21500456372729\n1986-09-17\t82.03101844721802\n1986-09-18\t80.79756801298375\n1986-09-19\t82.48198429064908\n1986-09-20\t82.11654744486819\n1986-09-21\t81.84746347357117\n1986-09-22\t82.42046293944811\n1986-09-23\t81.81034254516246\n1986-09-24\t81.94158716562434\n1986-09-25\t82.85678187829608\n1986-09-26\t84.0800329673248\n1986-09-27\t82.79305309160179\n1986-09-28\t82.28799360842218\n1986-09-29\t83.40682258287896\n1986-09-30\t83.86472306215481\n1986-10-01\t81.1353720362686\n1986-10-02\t81.1242795879088\n1986-10-03\t80.12091106377551\n1986-10-04\t79.92039894289442\n1986-10-05\t80.84311717821375\n1986-10-06\t80.52548732277565\n1986-10-07\t79.00981709557813\n1986-10-08\t79.39422316928335\n1986-10-09\t79.62389696867253\n1986-10-10\t78.2965502188096\n1986-10-11\t78.11263098959736\n1986-10-12\t79.95321043996536\n1986-10-13\t81.5089536448172\n1986-10-14\t80.21960613593549\n1986-10-15\t77.63936982947506\n1986-10-16\t73.21111674740871\n1986-10-17\t70.71447702758034\n1986-10-18\t74.18464865053322\n1986-10-19\t73.80382764402205\n1986-10-20\t72.89371209482702\n1986-10-21\t72.29950363568571\n1986-10-22\t72.42865127193946\n1986-10-23\t75.25323813973203\n1986-10-24\t75.5357189485414\n1986-10-25\t76.44699095273607\n1986-10-26\t76.7486847335614\n1986-10-27\t73.44465025173407\n1986-10-28\t73.2351871622679\n1986-10-29\t74.75454923516938\n1986-10-30\t73.49170883901449\n1986-10-31\t75.10341356075024\n1986-11-01\t77.35613731239748\n1986-11-02\t74.1347189082346\n1986-11-03\t71.81529937940805\n1986-11-04\t73.6997724961184\n1986-11-05\t74.88582394793903\n1986-11-06\t76.53681393404345\n1986-11-07\t78.47313662010372\n1986-11-08\t78.16628826932892\n1986-11-09\t78.31651728232374\n1986-11-10\t78.3792960887324\n1986-11-11\t77.14016771044892\n1986-11-12\t77.44153324286256\n1986-11-13\t77.07285010502466\n1986-11-14\t74.83309851885893\n1986-11-15\t70.80954990272092\n1986-11-16\t70.46998345271203\n1986-11-17\t74.90043708183401\n1986-11-18\t76.6204706951506\n1986-11-19\t75.04073501648172\n1986-11-20\t75.63495560580014\n1986-11-21\t70.98013814780619\n1986-11-22\t68.68022596283936\n1986-11-23\t75.12247254310441\n1986-11-24\t77.09198744052911\n1986-11-25\t77.3200277822939\n1986-11-26\t76.90242058614824\n1986-11-27\t74.56238096047758\n1986-11-28\t74.98295602610034\n1986-11-29\t76.9678419735164\n1986-11-30\t74.84177473390405\n1986-12-01\t73.56735723008771\n1986-12-02\t73.01553305307066\n1986-12-03\t65.81570875185072\n1986-12-04\t60.8669655236576\n1986-12-05\t61.79998733897841\n1986-12-06\t69.10294493854262\n1986-12-07\t70.91700884931684\n1986-12-08\t71.68729943205989\n1986-12-09\t72.79852207195707\n1986-12-10\t73.21415282198653\n1986-12-11\t75.74447709943716\n1986-12-12\t74.15639388398776\n1986-12-13\t65.67137209702604\n1986-12-14\t69.98414424617735\n1986-12-15\t69.17090924589041\n1986-12-16\t67.5762330840647\n1986-12-17\t64.8136587670365\n1986-12-18\t67.20889705651102\n1986-12-19\t66.2419359526632\n1986-12-20\t69.23270303964578\n1986-12-21\t63.327635457228105\n1986-12-22\t65.07254820972578\n1986-12-23\t68.68075012170775\n1986-12-24\t71.19997362184954\n1986-12-25\t66.2340402380283\n1986-12-26\t58.91170436887486\n1986-12-27\t60.521886750527855\n1986-12-28\t61.2714852402317\n1986-12-29\t60.709405039974705\n1986-12-30\t57.192286298659745\n1986-12-31\t60.36753228057785\n"},{"type":"TEXT","data":""}]}},{"text":"// Extra credit: find average temperature for Jan 28 for every year. Generate a line plot.\n// Was the Jan 28, 1986 temperature unusual?\n\nspark.udf.register(\"get_file_name\", (path: String) => path.split(\"/\").last.split(\"\\\\.\").head) // udf to get just file name (rather than entire path)\n\n// read in all temperature recordings\nval temps_all = spark.read.format(\"csv\").option(\"header\", \"true\").load(\"/Users/arunima/Desktop/ArunimaMAC/Education/Northeastern/Year_3/ds4300/HW/ds4300-challenger-accident/temperatures/*.csv\").toDF(\"STATION\", \"WBAN\", \"MONTH\", \"DAY\", \"TEMP\").withColumn(\"YEAR\", callUDF(\"get_file_name\", input_file_name()))\n// filter to only look at January 28th each year\nval temps_0128 =  temps_all.filter(($\"MONTH\" === \"01\") && ($\"DAY\" === \"28\")).selectExpr(\"STATION\", \"WBAN\", \"YEAR\", \"MONTH\", \"DAY\", \"cast(TEMP as double)\")\n// temperature recordings w/ \"valid\" stations\nval all_0128 = stations_weight.join(temps_0128, Seq(\"STATION\", \"WBAN\")).withColumn(\"weighted_temp\", $\"TEMP\" * $\"Weight\")\n\nall_0128.createOrReplaceTempView(\"all_0128\")","user":"anonymous","dateUpdated":"2020-04-10T10:39:26-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1586525230014_-722839656","id":"20200410-092710_591546168","dateCreated":"2020-04-10T09:27:10-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10985","dateFinished":"2020-04-10T10:39:28-0400","dateStarted":"2020-04-10T10:39:26-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"temps_all: org.apache.spark.sql.DataFrame = [STATION: string, WBAN: string ... 4 more fields]\ntemps_0128: org.apache.spark.sql.DataFrame = [STATION: string, WBAN: string ... 4 more fields]\nall_0128: org.apache.spark.sql.DataFrame = [STATION: string, WBAN: string ... 9 more fields]\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"YEAR":"string","estimated_temp":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"YEAR","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"estimated_temp","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1586527346114_-34634347","id":"20200410-100226_260842613","dateCreated":"2020-04-10T10:02:26-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:18097","text":"%sql\n-- Plot temperature on January 28th from 1975 to 2015, note 1986 being the lowest recorded in the dataset\nSELECT YEAR, SUM(weighted_temp)/SUM(Weight) AS estimated_temp\nFROM all_0128\nGROUP BY YEAR","dateUpdated":"2020-04-10T10:39:28-0400","dateFinished":"2020-04-10T10:43:35-0400","dateStarted":"2020-04-10T10:39:28-0400","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"YEAR\testimated_temp\n1987\t50.647128145721595\n2012\t63.32441713776399\n1988\t48.76585976170136\n1977\t64.36060638939493\n2014\t66.92475480544473\n1984\t62.767537132939765\n2013\t70.87406460733413\n1982\t60.59053921596698\n2005\t63.35051098041192\n2000\t50.332148578821844\n1981\t61.2707250542983\n1978\t46.817834413496584\n2002\t69.33342517200342\n2009\t71.01503520124857\n1995\t65.26595790527735\n2006\t66.44676740272796\n1976\t56.62708136800148\n2004\t52.68827201517223\n2011\t55.011362172328354\n1989\t66.69959360962777\n1992\t67.82271765790897\n2008\t55.30225153024208\n1999\t70.01220790356278\n1994\t73.98787525892828\n1997\t69.19351978868075\n2007\t64.8744758605194\n1996\t66.13887802207357\n1983\t55.968520175084166\n1980\t64.14672611593626\n1986\t36.98881742748224\n1985\t61.058173378597445\n1979\t58.72476093890588\n2015\t53.72092171633715\n1998\t58.80119333433912\n1993\t57.94212650730438\n2001\t56.281677239090534\n2010\t58.67650140007523\n1990\t69.7338514219439\n2003\t52.45872189550528\n1991\t72.33642760506243\n1975\t68.16990400144354\n"},{"type":"TEXT","data":""}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1586528450181_1749076513","id":"20200410-102050_603831104","dateCreated":"2020-04-10T10:20:50-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:18739","dateUpdated":"2020-04-10T10:43:35-0400"}],"name":"DS4300_The_Challenger_Accident","id":"2F6AFPNFB","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}